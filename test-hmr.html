<!DOCTYPE html>
<html>
<head>
    <title>HMR 测试页面</title>
    <meta charset="UTF-8">
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #1b2636;
            color: #fff;
        }
        .test-box {
            background: #2d3748;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .status {
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .success {
            background: #26a69a;
        }
        .error {
            background: #ef5350;
        }
        .info {
            background: #3b82f6;
        }
    </style>
</head>
<body>
    <h1>HMR 测试页面</h1>
    
    <div class="test-box">
        <h2>测试说明</h2>
        <p>这个页面用于测试 Vite HMR 是否正常工作。</p>
        <p>修改 <code>test-hmr.html</code> 文件，保存后应该看到自动更新。</p>
    </div>
    
    <div class="test-box">
        <h2>当前时间</h2>
        <div id="time" style="font-size: 24px; font-weight: bold;"></div>
    </div>
    
    <div class="test-box">
        <h2>HMR 状态</h2>
        <div id="hmr-status" class="status info">检查中...</div>
    </div>
    
    <div class="test-box">
        <h2>测试内容</h2>
        <p>如果你能看到这段文字，说明页面已加载。</p>
        <p style="color: #f97316;">如果你看到这段橙色文字，说明 HMR 正常工作！</p>
        <p style="color: #a855f7;">如果你看到这段紫色文字，说明页面已更新！</p>
    </div>

    <script>
        // 更新时间
        function updateTime() {
            const timeEl = document.getElementById('time');
            if (timeEl) {
                timeEl.textContent = new Date().toLocaleTimeString();
            }
        }
        setInterval(updateTime, 1000);
        updateTime();

        // 检查 HMR
        if (import.meta.hot) {
            document.getElementById('hmr-status').innerHTML = '<strong>✅ HMR 已启用</strong><br>WebSocket 连接正常';
            document.getElementById('hmr-status').className = 'status success';
            
            // 监听 HMR 更新
            import.meta.hot.on('vite:beforeUpdate', () => {
                console.log('HMR: 准备更新...');
            });
            
            import.meta.hot.on('vite:afterUpdate', () => {
                console.log('HMR: 更新完成');
                document.getElementById('hmr-status').innerHTML = '<strong>✅ HMR 已更新</strong><br>页面已自动刷新';
            });
        } else {
            document.getElementById('hmr-status').innerHTML = '<strong>❌ HMR 未启用</strong><br>这是生产构建，不支持热更新';
            document.getElementById('hmr-status').className = 'status error';
        }
    </script>
</body>
</html>

